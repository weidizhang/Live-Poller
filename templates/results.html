{% extends 'base.html' %}

{% block content %}
    <div class="text-center">
        {% if success %}<div class="alert alert-primary" role="alert">Thank you, your response has been recorded.</div>{% endif %}
        {% if already_voted %}<div class="alert alert-danger" role="alert">You already submitted a response for this poll.</div>{% endif %}
        {% if closed %}<div class="alert alert-danger" role="alert">The poll you are trying to vote on is already closed.</div>{% endif %}

        <h2>{{ question }}</h2>
        <span class="badge badge-pill badge-info">Closes {{ closes|format_timestamp }}</span>
        <br>
        {% set total_responses = sum(responses.values()) %}
        {% for response_id, count in responses.items() %}
            <div class="answer-row w-75">
                <div class="response-title">{{ choices[int(response_id) - 1] }}</div>
                <div class="progress">
                    {% set percentage = 0.0 if total_responses == 0 else round(count / total_responses * 100, 1) %}
                    {% set additional_style = " color: black; margin-left: 10px;" if count == 0 else "" %}
                    <div class="progress-bar" role="progressbar" style="width: {{ percentage }}%;{{ additional_style }}" aria-valuenow="{{ percentage }}" aria-valuemin="0" aria-valuemax="100">
                        {{ count }} vote{{ "s" if count != 1 else "" }} ({{ percentage }}%)
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>
{% endblock %}